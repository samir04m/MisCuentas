{% extends 'base/base.html' %}
{% load static %}
{% load misTags %}

{% block title %}Solicitudes de prestamos{% endblock %}

{% block contenido %}
    <div class="container">
        <div class="card animate__animated animate__fadeIn my-4">
            <div class="card-body">
                <h5 class="text-center mb-3">Solicitudes de creaci√≥n de prestamos</h5>
                {% if solicitudesCreacion %}
                    <table class="table table-responsive-sm" id="datatable">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Usuario</th>
                                <th>Tipo</th>
                                <th>Valor</th>
                                <th>Cuenta</th>
                                <th>Info</th>
                                <th>Estado</th>
                                <th>Opciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in solicitudesCreacion %}
                                <tr>
                                    <td>
                                        <span class="d-none d-md-block">
                                            {{item.fechaSolicitud|date:'D, d/m/y h:iA'}}
                                        </span>
                                        <span  class="d-md-none">
                                            {{item.fechaSolicitud|date:'d/m/y h:iA'}}
                                        </span>
                                    </td>
                                    <td>{{item.persona.nombre}}</td>
                                    <td>{{item.tipo|tipoPrestamo}}</td>
                                    <td>{{item.valor|dinero}}</td>
                                    <td>{{item.cuenta.nombre}}</td>
                                    <td>
                                        <button type="button" class="btn btn-outline-secondary btn-sm" data-toggle="tooltip" data-placement="bottom" 
                                            data-html="true" title="{{item.info}} <br> Fecha prestamo: {{item.fechaPrestamo}}">
                                            <i class="fal fa-info"></i>
                                        </button>
                                    </td>
                                    <td>{{item.estado|estadoSolicitudPagoPrestamo}}</td>
                                    <td>
                                        {% if item.estado == 0 %}
                                            <a href="{% url 'panel:cambiarEstadoSolicitudCreacionPrestamo' item.id 2 %}" class="btn btn-outline-danger btn-sm">
                                                <i class="fal fa-times-circle"></i>
                                            </a>
                                            <a href="{% url 'panel:cambiarEstadoSolicitudCreacionPrestamo' item.id 1 %}" class="btn btn-outline-primary btn-sm">
                                                <i class="fal fa-check-circle"></i>
                                            </a>
                                        {% else %}
                                            <a href="{% url 'panel:vista_prestamo' item.id %}" class="btn btn-outline-primary btn-sm">
                                                Ver prestamo
                                            </a>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <div class="fs-18 text-center text-secondary">
                        <i class="fal fa-transporter-empty fa-4x"></i> <br><br>
                        No hay solicitudes
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block script %}
    <script type="text/javascript">
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        });
    </script>
{% endblock %}

